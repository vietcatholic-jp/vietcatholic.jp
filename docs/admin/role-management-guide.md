# H∆∞·ªõng d·∫´n Qu·∫£n l√Ω Vai tr√≤ - Admin Guide

## T·ªïng quan

H·ªá th·ªëng qu·∫£n l√Ω vai tr√≤ gi√∫p ph√¢n lo·∫°i v√† t·ªï ch·ª©c ng∆∞·ªùi tham gia s·ª± ki·ªán m·ªôt c√°ch hi·ªáu qu·∫£. T√≠nh nƒÉng n√†y ƒë∆∞·ª£c thi·∫øt k·∫ø ƒë·ªÉ h·ªó tr·ª£ admin trong vi·ªác:

- Ph√¢n chia ng∆∞·ªùi tham gia theo vai tr√≤ c·ª• th·ªÉ
- Xu·∫•t d·ªØ li·ªáu v·ªõi th√¥ng tin vai tr√≤ r√µ r√†ng
- Th·ªëng k√™ v√† b√°o c√°o theo vai tr√≤
- Ph√¢n ƒë·ªôi d·ª±a tr√™n vai tr√≤ v√† k·ªπ nƒÉng

## C√°c lo·∫°i vai tr√≤

### 1. üîµ Tham gia
- **M√¥ t·∫£**: Ng∆∞·ªùi tham gia s·ª± ki·ªán v·ªõi vai tr√≤ c∆° b·∫£n
- **V√≠ d·ª•**: Tham d·ª± vi√™n
- **M√†u s·∫Øc**: Xanh d∆∞∆°ng
- **ƒê·∫∑c ƒëi·ªÉm**: Kh√¥ng c√≥ tr√°ch nhi·ªám t·ªï ch·ª©c c·ª• th·ªÉ

### 2. üü¢ T√¨nh nguy·ªán
- **M√¥ t·∫£**: Ng∆∞·ªùi t√¨nh nguy·ªán h·ªó tr·ª£ t·ªï ch·ª©c s·ª± ki·ªán
- **V√≠ d·ª•**: 
  - Tr∆∞·ªüng ban Truy·ªÅn th√¥ng
  - Th√†nh vi√™n ban Sinh ho·∫°t
  - Ph√≥ ban Y t·∫ø
- **M√†u s·∫Øc**: Xanh l√°
- **ƒê·∫∑c ƒëi·ªÉm**: ƒê∆∞·ª£c ph√¢n chia th√†nh c√°c ban chuy√™n m√¥n

### 3. üü£ T·ªï ch·ª©c
- **M√¥ t·∫£**: Ng∆∞·ªùi c√≥ tr√°ch nhi·ªám t·ªï ch·ª©c v√† ƒëi·ªÅu h√†nh s·ª± ki·ªán
- **V√≠ d·ª•**:
  - Ban T·ªï ch·ª©c ch√≠nh
  - Ban T·ªï ch·ª©c khu v·ª±c
- **M√†u s·∫Øc**: T√≠m
- **ƒê·∫∑c ƒëi·ªÉm**: C√≥ quy·ªÅn quy·∫øt ƒë·ªãnh v√† tr√°ch nhi·ªám cao

### 4. üü† ƒê·∫∑c bi·ªát
- **M√¥ t·∫£**: Ng∆∞·ªùi c√≥ vai tr√≤ ƒë·∫∑c bi·ªát trong s·ª± ki·ªán
- **V√≠ d·ª•**:
  - Di·ªÖn gi·∫£
  - Ngh·ªá sƒ© bi·ªÉu di·ªÖn
- **M√†u s·∫Øc**: Cam
- **ƒê·∫∑c ƒëi·ªÉm**: Kh√°ch m·ªùi ho·∫∑c ng∆∞·ªùi c√≥ t√†i nƒÉng ƒë·∫∑c bi·ªát

## T√≠nh nƒÉng ch√≠nh

### 1. Hi·ªÉn th·ªã vai tr√≤ trong giao di·ªán

#### Role Badge
- Hi·ªÉn th·ªã t√™n vai tr√≤ b·∫±ng ti·∫øng Vi·ªát
- Color coding theo lo·∫°i vai tr√≤
- Tooltip v·ªõi th√¥ng tin chi ti·∫øt
- Responsive tr√™n m·ªçi thi·∫øt b·ªã

#### V·ªã tr√≠ hi·ªÉn th·ªã
- Dashboard admin
- Danh s√°ch ƒëƒÉng k√Ω
- Chi ti·∫øt registration
- Giao di·ªán ph√¢n ƒë·ªôi
- Export preview

### 2. Export d·ªØ li·ªáu v·ªõi vai tr√≤

#### CSV Export
- C·ªôt "Vai tr√≤" trong t·∫•t c·∫£ file export
- T√™n vai tr√≤ b·∫±ng ti·∫øng Vi·ªát (kh√¥ng ph·∫£i m√£)
- T∆∞∆°ng th√≠ch v·ªõi Excel v√† Google Sheets

#### C√°c lo·∫°i export
- **Registration Export**: Vai tr√≤ c·ªßa ng∆∞·ªùi ƒëƒÉng k√Ω ch√≠nh
- **Registrants Export**: Vai tr√≤ c·ªßa t·ª´ng ng∆∞·ªùi tham gia
- **Teams Export**: Vai tr√≤ trong context ph√¢n ƒë·ªôi

### 3. Th·ªëng k√™ vai tr√≤

#### Dashboard Statistics
- Bi·ªÉu ƒë·ªì ph√¢n b·ªë theo lo·∫°i vai tr√≤
- Top 10 vai tr√≤ c√≥ nhi·ªÅu ng∆∞·ªùi nh·∫•t
- Th·ªëng k√™ chi ti·∫øt theo tr·∫°ng th√°i ƒëƒÉng k√Ω

#### Metrics hi·ªÉn th·ªã
- T·ªïng s·ªë ng∆∞·ªùi theo vai tr√≤
- S·ªë ng∆∞·ªùi ƒë√£ x√°c nh·∫≠n
- S·ªë ng∆∞·ªùi ƒë√£ thanh to√°n
- S·ªë ng∆∞·ªùi ch·ªù x·ª≠ l√Ω

### 4. Filter v√† t√¨m ki·∫øm

#### Role Filter
- Multi-select dropdown
- Search trong danh s√°ch vai tr√≤
- Group theo category
- Clear all filters

#### ·ª®ng d·ª•ng
- L·ªçc danh s√°ch registrants
- T√¨m ki·∫øm trong team assignment
- Filter trong export preview

## H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng

### 1. Xem th·ªëng k√™ vai tr√≤

1. ƒêƒÉng nh·∫≠p admin dashboard
2. Scroll xu·ªëng ph·∫ßn "Th·ªëng k√™ theo vai tr√≤"
3. Xem bi·ªÉu ƒë·ªì ph√¢n b·ªë v√† top roles
4. Click v√†o chi ti·∫øt ƒë·ªÉ xem th√™m th√¥ng tin

### 2. Export d·ªØ li·ªáu v·ªõi vai tr√≤

1. V√†o trang Registration Manager Export
2. Ch·ªçn filters c·∫ßn thi·∫øt
3. Click "Export CSV"
4. M·ªü file ƒë·ªÉ ki·ªÉm tra c·ªôt "Vai tr√≤"

### 3. Ph√¢n ƒë·ªôi theo vai tr√≤

1. V√†o trang Team Assignment
2. Xem danh s√°ch ng∆∞·ªùi ch∆∞a ph√¢n ƒë·ªôi
3. S·ª≠ d·ª•ng role filter ƒë·ªÉ l·ªçc theo vai tr√≤
4. Assign ng∆∞·ªùi v√†o ƒë·ªôi ph√π h·ª£p
5. Xem vai tr√≤ trong dialog assignment

### 4. S·ª≠ d·ª•ng Role Filter

1. Click v√†o dropdown "L·ªçc theo vai tr√≤"
2. Search ho·∫∑c browse danh s√°ch
3. Select multiple roles n·∫øu c·∫ßn
4. Xem k·∫øt qu·∫£ filtered
5. Clear filters khi c·∫ßn reset

## Troubleshooting

### V·∫•n ƒë·ªÅ th∆∞·ªùng g·∫∑p

#### 1. Vai tr√≤ hi·ªÉn th·ªã "Ch∆∞a ph√¢n vai tr√≤"
**Nguy√™n nh√¢n**: Ng∆∞·ªùi tham gia ch∆∞a ƒë∆∞·ª£c g√°n vai tr√≤ c·ª• th·ªÉ
**Gi·∫£i ph√°p**: 
- Li√™n h·ªá admin ƒë·ªÉ g√°n vai tr√≤
- Ho·∫∑c ƒë·ªÉ m·∫∑c ƒë·ªãnh n·∫øu l√† tham d·ª± vi√™n th√¥ng th∆∞·ªùng

#### 2. Export CSV kh√¥ng c√≥ c·ªôt vai tr√≤
**Nguy√™n nh√¢n**: S·ª≠ d·ª•ng endpoint export c≈©
**Gi·∫£i ph√°p**:
- S·ª≠ d·ª•ng export t·ª´ Registration Manager
- Ho·∫∑c Admin Dashboard export

#### 3. Role statistics kh√¥ng load
**Nguy√™n nh√¢n**: L·ªói API ho·∫∑c quy·ªÅn truy c·∫≠p
**Gi·∫£i ph√°p**:
- Refresh trang
- Ki·ªÉm tra quy·ªÅn admin
- Li√™n h·ªá technical support

#### 4. Role filter kh√¥ng ho·∫°t ƒë·ªông
**Nguy√™n nh√¢n**: JavaScript error ho·∫∑c data loading
**Gi·∫£i ph√°p**:
- Hard refresh (Ctrl+F5)
- Clear browser cache
- Ki·ªÉm tra console errors

### Performance Tips

#### 1. T·ªëi ∆∞u loading
- Role statistics c√≥ th·ªÉ m·∫•t 2-3 gi√¢y ƒë·ªÉ load
- S·ª≠ d·ª•ng pagination khi c√≥ nhi·ªÅu data
- Filter ƒë·ªÉ gi·∫£m s·ªë l∆∞·ª£ng records hi·ªÉn th·ªã

#### 2. Export l·ªõn
- V·ªõi >1000 records, export c√≥ th·ªÉ m·∫•t 5-10 gi√¢y
- S·ª≠ d·ª•ng filters ƒë·ªÉ gi·∫£m data size
- Export theo batch n·∫øu c·∫ßn

## API Reference

### Endpoints m·ªõi

#### GET `/api/admin/statistics/roles`
L·∫•y th·ªëng k√™ vai tr√≤ cho dashboard

**Response**:
```json
{
  "success": true,
  "data": [
    {
      "role_name": "Ban t·ªï ch·ª©c c·ªët c√°n",
      "role_label": "Ban t·ªï ch·ª©c c·ªët c√°n", 
      "total_count": 15,
      "confirmed_count": 12,
      "paid_count": 10,
      "pending_count": 3
    }
  ],
  "total_registrants": 500
}
```

### Updated Endpoints

#### GET `/api/admin/export`
B√¢y gi·ªù include role information trong response

#### GET `/api/admin/teams/export`
Th√™m c·ªôt "Vai tr√≤" trong CSV export

## Technical Notes

### Database Schema
- S·ª≠ d·ª•ng b·∫£ng `event_roles` thay v√¨ enum
- Li√™n k·∫øt qua `registrants.event_role_id`
- Support multiple events v·ªõi roles kh√°c nhau

### Component Architecture
- `RoleBadge`: Reusable role display component
- `RoleFilter`: Advanced filtering component  
- `RoleStatistics`: Dashboard statistics
- `RoleHelp`: User guidance component

### Utilities
- `lib/role-utils.ts`: Core role processing functions
- Color coding v√† categorization
- Vietnamese label mapping

## Changelog

### Version 2.0 (Current)
- ‚úÖ Th√™m c·ªôt vai tr√≤ v√†o t·∫•t c·∫£ exports
- ‚úÖ Role statistics dashboard
- ‚úÖ Advanced role filtering
- ‚úÖ Enhanced UI v·ªõi tooltips
- ‚úÖ Comprehensive documentation

### Version 1.0 (Legacy)
- Basic role enum support
- Limited export functionality
- No statistics or filtering

---

**C·∫≠p nh·∫≠t l·∫ßn cu·ªëi**: 2025-07-24  
**Phi√™n b·∫£n**: 2.0  
**Ng∆∞·ªùi vi·∫øt**: AI Assistant
